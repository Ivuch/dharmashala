<html>
<head>
	<title>RA</title>
</head>
<body>


<script>
      //RA
      function getCameraContext(){
var canvas = document.createElement('canvas');
var ctx = canvas.getContext('2d');
  // Create a RGB raster object for the 2D canvas.
// JSARToolKit uses raster objects to read image data.
// Note that you need to set canvas.changed = true on every frame.
var raster = new NyARRgbRaster_Canvas2D(canvas);

// FLARParam is the thing used by FLARToolKit to set camera parameters.
// Here we create a FLARParam for images with 320x240 pixel dimensions.
var param = new FLARParam(320, 240);

// The FLARMultiIdMarkerDetector is the actual detection engine for marker detection.
// It detects multiple ID markers. ID markers are special markers that encode a number.
var detector = new FLARMultiIdMarkerDetector(param, 120);

// For tracking video set continue mode to true. In continue mode, the detector
// tracks markers across multiple frames.
detector.setContinueMode(true);

// Copy the camera perspective matrix from the FLARParam to the WebGL library camera matrix.
// The second and third parameters determine the zNear and zFar planes for the perspective matrix.
param.copyCameraMatrix(display.camera.perspectiveMatrix, 10, 10000);

//2!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
var video = document.createElement('video');
video.width = 320;
video.height = 240;

var getUserMedia = function(t, onsuccess, onerror) {
  if (navigator.getUserMedia) {
    return navigator.getUserMedia(t, onsuccess, onerror);
  } else if (navigator.webkitGetUserMedia) {
    return navigator.webkitGetUserMedia(t, onsuccess, onerror);
  } else if (navigator.mozGetUserMedia) {
    return navigator.mozGetUserMedia(t, onsuccess, onerror);
  } else if (navigator.msGetUserMedia) {
    return navigator.msGetUserMedia(t, onsuccess, onerror);
  } else {
    onerror(new Error("No getUserMedia implementation found."));
  }
};

var URL = window.URL || window.webkitURL;
var createObjectURL = URL.createObjectURL || webkitURL.createObjectURL;
if (!createObjectURL) {
  throw new Error("URL.createObjectURL not found.");
}

getUserMedia({'video': true},
  function(stream) {
    var url = createObjectURL(stream);
    video.src = url;
  },
  function(error) {
    alert("Couldn't access webcam.");
  }
);
// Draw the video frame to the raster canvas, scaled to 320x240.
canvas.getContext('2d').drawImage(video, 0, 0, 320, 240);

// Tell the raster object that the underlying canvas has changed.
canvas.changed = true;

// Do marker detection by using the detector object on the raster object.
// The threshold parameter determines the threshold value
// for turning the video frame into a 1-bit black-and-white image.
//
var markerCount = detector.detectMarkerLite(raster, threshold);

//3!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// Create a NyARTransMatResult object for getting the marker translation matrices.
var resultMat = new NyARTransMatResult();

var markers = {};

// Go through the detected markers and get their IDs and transformation matrices.
for (var idx = 0; idx < markerCount; idx++) {
  // Get the ID marker data for the current marker.
  // ID markers are special kind of markers that encode a number.
  // The bytes for the number are in the ID marker data.
  var id = detector.getIdMarkerData(idx);

  // Read bytes from the id packet.
  var currId = -1;
  // This code handles only 32-bit numbers or shorter.
  if (id.packetLength <= 4) {
    currId = 0;
    for (var i = 0; i < id.packetLength; i++) {
      currId = (currId << 8) | id.getPacketData(i);
    }
  }

  // If this is a new id, let's start tracking it.
  if (markers[currId] == null) {
    markers[currId] = {};
  }
  // Get the transformation matrix for the detected marker.
  detector.getTransformMatrix(idx, resultMat);

  // Copy the result matrix into our marker tracker object.
  markers[currId].transform = Object.asCopy(resultMat);
}
//4!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
function copyMarkerMatrix(arMat, glMat) {
  glMat[0] = arMat.m00;
  glMat[1] = -arMat.m10;
  glMat[2] = arMat.m20;
  glMat[3] = 0;
  glMat[4] = arMat.m01;
  glMat[5] = -arMat.m11;
  glMat[6] = arMat.m21;
  glMat[7] = 0;
  glMat[8] = -arMat.m02;
  glMat[9] = arMat.m12;
  glMat[10] = -arMat.m22;
  glMat[11] = 0;
  glMat[12] = arMat.m03;
  glMat[13] = -arMat.m13;
  glMat[14] = arMat.m23;
  glMat[15] = 1;
}
}
  </script>
  <script src="js/src/NyAs3Utils.js"></script>
<script src="js/src/FLARArrayUtil.js"></script>
<script src="js/src/FLARException.js"></script>
<script src="js/src/FLARMat.js"></script>
<script src="js/src/FLARRgbPixelReader.js"></script>
<script src="js/src/NyARHistogramAnalyzer.js"></script>
<script src="js/src/NyARPca2d.js"></script>
<script src="js/src/NyARRasterReader.js"></script>
<script src="js/src/NyARTypes.js"></script>
<script src="js/src/FLARRasterFilter.js"></script>
<script src="js/src/FLARTypes.js"></script>
<script src="js/src/NyARLabel.js"></script>
<script src="js/src/FLARLabeling.js"></script>
<script src="js/src/NyARParam.js"></script>
<script src="js/src/FLARParam.js"></script>
<script src="js/src/NyARRaster.js"></script>
<script src="js/src/FLARRaster.js"></script>
<script src="js/src/NyARCode.js"></script>
<script src="js/src/FLARCode.js"></script>
<script src="js/src/NyARMatch.js"></script>
<script src="js/src/NyARRasterAnalyzer.js"></script>
<script src="js/src/FLARRasterAnalyzer.js"></script>
<script src="js/src/NyARRasterFilter.js"></script>
<script src="js/src/NyARSquareDetect.js"></script>
<script src="js/src/FLARSquareDetect.js"></script>
<script src="js/src/NyARTransMat.js"></script>
<script src="js/src/FLARTransMat.js"></script>
<script src="js/src/NyARUtils.js"></script>
<script src="js/src/NyARIdMarker.js"></script>
<script src="js/src/NyARPickup.js"></script>
<script src="js/src/FLARProcessor.js"></script>
<script src="js/src/NyARDetector.js"></script>
<script src="js/src/FLARDetector.js"></script>
<script src="js/src/FLARIdMarkerDetector.js"></script>
<script src="js/src/NyARSingleMarkerProcesser.js"></script>
<script src="js/src/NyUtils.js"></script>
<script src="js/JSARToolKit.js"></script>
</body>
</html>